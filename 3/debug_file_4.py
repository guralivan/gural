import pandas as pd
import os

def debug_file_4():
    """–î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∞–π–ª 4.xlsx"""
    
    print("üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ 4.xlsx")
    
    if not os.path.exists('4.xlsx'):
        print("‚ùå –§–∞–π–ª 4.xlsx –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return
    
    try:
        df = pd.read_excel('4.xlsx')
        print(f"‚úÖ –§–∞–π–ª 4.xlsx —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω")
        print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–±—Ü—ã —Å –¥–∞—Ç–∞–º–∏
        if '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' in df.columns and '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞' in df.columns:
            print("\nüìÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç:")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏
            print(f"üìã –ü–µ—Ä–≤—ã–µ 3 –∑–∞–ø–∏—Å–∏:")
            for i in range(min(3, len(df))):
                print(f"  {i+1}. –ù–∞—á–∞–ª–æ: {df.iloc[i]['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞']}, –ö–æ–Ω–µ—Ü: {df.iloc[i]['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞']}")
            
            print(f"\nüìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∑–∞–ø–∏—Å–∏:")
            for i in range(max(0, len(df)-3), len(df)):
                print(f"  {i+1}. –ù–∞—á–∞–ª–æ: {df.iloc[i]['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞']}, –ö–æ–Ω–µ—Ü: {df.iloc[i]['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞']}")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ
            if '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ' in df.columns:
                legal_entities = df['–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ'].unique()
                print(f"\nüè¢ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞: {legal_entities}")
        else:
            print("‚ùå –°—Ç–æ–ª–±—Ü—ã —Å –¥–∞—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã: {list(df.columns)}")
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}")

if __name__ == "__main__":
    debug_file_4()
