#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import pandas as pd
import streamlit as st

def debug_tab2_data():
    """–û—Ç–ª–∞–¥–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ç–æ—Ä–æ–π –≤–∫–ª–∞–¥–∫–µ"""
    
    st.markdown("## üîç –û—Ç–ª–∞–¥–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Ç–æ—Ä–æ–π –≤–∫–ª–∞–¥–∫–∏")
    
    try:
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        st.info("üìÅ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª 3.xlsx...")
        df = pd.read_excel('3.xlsx')
        st.success(f"‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: {len(df)} –∑–∞–ø–∏—Å–µ–π")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–±—Ü—ã
        st.info("üìã –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–±—Ü—ã...")
        st.write("–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã:", list(df.columns))
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã
        st.info("üìÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã...")
        if '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' in df.columns and '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞' in df.columns:
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—ã
            df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'], errors='coerce')
            df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'], errors='coerce')
            
            # –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç—ã–µ –¥–∞—Ç—ã
            df_clean = df.dropna(subset=['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'])
            st.success(f"‚úÖ –û—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {len(df_clean)} –∑–∞–ø–∏—Å–µ–π")
            
            # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ –≥–æ–¥–∞–º
            df_clean['–ì–æ–¥'] = df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year
            year_counts = df_clean['–ì–æ–¥'].value_counts().sort_index()
            
            st.info("üìä –ê–Ω–∞–ª–∏–∑ –ø–æ –≥–æ–¥–∞–º:")
            for year, count in year_counts.items():
                st.write(f"  {year}: {count} –∑–∞–ø–∏—Å–µ–π")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞ 2025
            data_2025 = df_clean[df_clean['–ì–æ–¥'] == 2025]
            if len(data_2025) > 0:
                st.success(f"‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞ 2025 –≥–æ–¥ –Ω–∞–π–¥–µ–Ω—ã: {len(data_2025)} –∑–∞–ø–∏—Å–µ–π")
                st.write(f"üìÖ –ü–µ—Ä–∏–æ–¥ 2025: {data_2025['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()} - {data_2025['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π 2025
                st.write("üìã –ü–µ—Ä–≤—ã–µ –∑–∞–ø–∏—Å–∏ 2025 –≥–æ–¥–∞:")
                st.dataframe(data_2025.head())
            else:
                st.error("‚ùå –î–∞–Ω–Ω—ã–µ –∑–∞ 2025 –≥–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
                
        else:
            st.error("‚ùå –°—Ç–æ–ª–±—Ü—ã —Å –¥–∞—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            
    except Exception as e:
        st.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")

if __name__ == "__main__":
    debug_tab2_data()






