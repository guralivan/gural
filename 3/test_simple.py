import pandas as pd

def test_dates():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞—Ç"""
    
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞—Ç")
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
    print("\nüìÅ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª 4.xlsx...")
    df = pd.read_excel('4.xlsx')
    print(f"üìä –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {df.shape}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    print(f"üìÖ –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞—Ç—ã:")
    print(f"  –ü–µ—Ä–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: {df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()}")
    print(f"  –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞: {df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—ã
    print("\nüîÑ –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—ã...")
    df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'], errors='coerce')
    df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'], errors='coerce')
    
    print(f"üìÖ –ü–æ—Å–ª–µ pd.to_datetime:")
    print(f"  –ü–µ—Ä–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: {df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()}")
    print(f"  –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞: {df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
    
    # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã
    print("\nüîÑ –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã...")
    for col in ['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞']:
        if pd.api.types.is_datetime64_any_dtype(df[col]):
            if hasattr(df[col].dt, 'tz') and df[col].dt.tz is not None:
                df[col] = df[col].dt.tz_localize(None)
                print(f"  –£–¥–∞–ª–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã –∏–∑ {col}")
            else:
                print(f"  –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ {col}")
    
    print(f"üìÖ –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω:")
    print(f"  –ü–µ—Ä–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: {df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()}")
    print(f"  –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞: {df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
    
    # –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞—Ç–∞–º–∏
    print("\nüîÑ –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞—Ç–∞–º–∏...")
    df_clean = df.dropna(subset=['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'])
    print(f"üìä –†–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏: {df_clean.shape}")
    
    print(f"üìÖ –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:")
    print(f"  –ü–µ—Ä–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: {df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()}")
    print(f"  –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞: {df_clean['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ –Ω–∞—á–∞–ª–∞
    print("\nüîÑ –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ –Ω–∞—á–∞–ª–∞...")
    df_sorted = df_clean.sort_values('–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞')
    
    print(f"üìÖ –ü–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:")
    print(f"  –ü–µ—Ä–≤–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: {df_sorted['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()}")
    print(f"  –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞: {df_sorted['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≥–æ–¥–∞–º
    records_2024 = len(df_sorted[df_sorted['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year == 2024])
    records_2025 = len(df_sorted[df_sorted['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year == 2025])
    
    print(f"üìà –î–∞–Ω–Ω—ã–µ –ø–æ –≥–æ–¥–∞–º:")
    print(f"  2024 –≥–æ–¥: {records_2024} –∑–∞–ø–∏—Å–µ–π")
    print(f"  2025 –≥–æ–¥: {records_2025} –∑–∞–ø–∏—Å–µ–π")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π
    print(f"\nüìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –∑–∞–ø–∏—Å–µ–π:")
    last_records = df_sorted.tail(5)
    for i, (idx, row) in enumerate(last_records.iterrows(), 1):
        print(f"  {i}. {row['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞']} - {row['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞']} (–≥–æ–¥: {row['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].year})")

if __name__ == "__main__":
    test_dates()




