import pandas as pd
import os

def check_2025_data():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 2025 –≥–æ–¥ –≤ —Ñ–∞–π–ª–µ 3.xlsx"""
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
        if not os.path.exists('3.xlsx'):
            print("‚ùå –§–∞–π–ª 3.xlsx –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            return
        
        print("üìÅ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª 3.xlsx...")
        df = pd.read_excel('3.xlsx')
        
        print(f"üìä –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫: {len(df)}")
        print(f"üìã –ö–æ–ª–æ–Ω–∫–∏: {list(df.columns)}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–æ–ª–æ–Ω–æ–∫ —Å –¥–∞—Ç–∞–º–∏
        if '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' not in df.columns or '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞' not in df.columns:
            print("‚ùå –ö–æ–ª–æ–Ω–∫–∏ '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' –∏–ª–∏ '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            return
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—ã
        df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'], errors='coerce')
        df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'] = pd.to_datetime(df['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'], errors='coerce')
        
        # –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞—Ç–∞–º–∏
        df_clean = df.dropna(subset=['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'])
        print(f"üìä –°—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞—Ç: {len(df_clean)}")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≥–æ–¥–∞–º
        records_2024 = len(df_clean[df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year == 2024])
        records_2025 = len(df_clean[df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year == 2025])
        
        print(f"üìà 2024 –≥–æ–¥: {records_2024} –∑–∞–ø–∏—Å–µ–π")
        print(f"üìà 2025 –≥–æ–¥: {records_2025} –∑–∞–ø–∏—Å–µ–π")
        
        if records_2025 > 0:
            data_2025 = df_clean[df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year == 2025]
            print(f"‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞ 2025 –≥–æ–¥ –Ω–∞–π–¥–µ–Ω—ã!")
            print(f"üìÖ –ü–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å 2025: {data_2025['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min().strftime('%d.%m.%Y')}")
            print(f"üìÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å 2025: {data_2025['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max().strftime('%d.%m.%Y')}")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø–∏—Å–µ–π 2025
            print("\nüìã –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø–∏—Å–µ–π –∑–∞ 2025 –≥–æ–¥:")
            print(data_2025[['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞', '–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞']].head())
        else:
            print("‚ùå –î–∞–Ω–Ω—ã–µ –∑–∞ 2025 –≥–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
            min_date = df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].min()
            max_date = df_clean['–î–∞—Ç–∞ –∫–æ–Ω—Ü–∞'].max()
            print(f"üìÖ –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –≤ —Ñ–∞–π–ª–µ: —Å {min_date.strftime('%d.%m.%Y')} –ø–æ {max_date.strftime('%d.%m.%Y')}")
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥–æ–¥—ã
            years = sorted(df_clean['–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞'].dt.year.unique())
            print(f"üìÖ –ì–æ–¥—ã –≤ —Ñ–∞–π–ª–µ: {years}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        print(f"–î–µ—Ç–∞–ª–∏: {traceback.format_exc()}")

if __name__ == "__main__":
    check_2025_data()
