#!/bin/bash

# üöÄ –°–ö–†–ò–ü–¢ –ó–ê–ü–£–°–ö–ê –í–°–ï–• –ü–†–ò–õ–û–ñ–ï–ù–ò–ô
# üìç –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª

echo "üöÄ –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–ô WB"
echo "================================"
echo ""

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
APPS_PATH="/Users/ivangural/Downloads/wb_dashboard_streamlit"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
if [ ! -d "$APPS_PATH" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –ü–∞–ø–∫–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!"
    echo "   –û–∂–∏–¥–∞–µ–º—ã–π –ø—É—Ç—å: $APPS_PATH"
    exit 1
fi

echo "üìÅ –ü–∞–ø–∫–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏: $APPS_PATH"
echo ""

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
launch_app() {
    local app_name="$1"
    local app_path="$2"
    local port="$3"
    
    echo "üéØ –ó–∞–ø—É—Å–∫: $app_name"
    echo "üìç –ü—É—Ç—å: $app_path"
    echo "üåê –ü–æ—Ä—Ç: $port"
    echo ""
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    cd "$app_path"
    
    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    if [ -d "venv" ]; then
        source venv/bin/activate
    elif [ -d ".venv" ]; then
        source .venv/bin/activate
    else
        echo "‚ö†Ô∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π Python"
    fi
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    streamlit run "$app_name" --server.port "$port" --server.address localhost &
    
    echo "‚úÖ $app_name –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ http://localhost:$port"
    echo "----------------------------------------"
    echo ""
}

# –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
echo "üöÄ –ó–ê–ü–£–°–ö–ê–ï–ú –í–°–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø..."
echo ""

# 1. –Æ–Ω–∏—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∞
launch_app "unit_economics_products_table_FINAL.py" "$APPS_PATH" "8501"

# 2. –î–∞—à–±–æ—Ä–¥
launch_app "dashboard_final.py" "$APPS_PATH" "8502"

# 3. –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–æ–≤
launch_app "weekly_expenses_analyzer_final_stable.py" "$APPS_PATH/3" "8503"

echo "üéâ –í–°–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø –ó–ê–ü–£–©–ï–ù–´!"
echo ""
echo "üìä –î–û–°–¢–£–ü–ù–´–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø:"
echo "   üè≠ –Æ–Ω–∏—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∞: http://localhost:8501"
echo "   üìà –î–∞—à–±–æ—Ä–¥: http://localhost:8502"
echo "   üìã –ê–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–æ–≤: http://localhost:8503"
echo ""
echo "üí° –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞–∂–º–∏—Ç–µ Ctrl+C"
echo ""

# –ñ–¥–µ–º –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π..."

echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
pkill -f streamlit
echo "‚úÖ –í—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"
